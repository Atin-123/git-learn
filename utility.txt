This is a utility function file version 2 and tut no.6.